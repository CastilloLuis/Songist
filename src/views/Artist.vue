<template>

<section style="padding: 20px 20px 20px 20px; margin-top: 0%">
    <div class="columns is-full-mobile is-two-thirds-tablet" >
        <div class="column">
            <div class="" style="margin-top: 20%">
                <div class="container is-fluid">
                    <img :src="artistData.picture_big" alt="" style="width: 100%;">
                </div>
                <div class=" has-text-centere">
                    <div style="text-align: center">
                        <h1 class="title is-3" style="color: white;">{{artistData.name}}</h1>
                    </div>
                </div>
            </div>

        </div>
        <div class="column is-three-fifths">
            <div style="text-align: center; margin-bottom: 1%;">
                 <b-tag type="is-warning" size="is-large" style="font-weight: bold;">ðŸŽ¶ðŸŽµ HITS ðŸŽ¶ðŸŽµ</b-tag>
            </div>
            <b-table
                :data="artistTopTracks"
                paginated
                per-page="5"
                default-sort="user.released"
                style="background-color: white; padding: 10px 10px 10px 10px"
            >

                <template slot-scope="props">

                    <b-table-column field="id" label="ID" width="40" numeric centered sortable >
                        {{ props.row.id }} 
                    </b-table-column>

                    <b-table-column field="title" label="Song Name" sortable centered>
                        {{ props.row.title }}
                    </b-table-column>

                    <b-table-column field="released" label="Released" sortable centered>
                        <audio :id="props.row.id" :src="props.row.preview" :ref="props.row.id">
                        </audio>
                        <button @click="playPreview(props.row.id)" :ref="props.row.id+'action'" style="background-color: transparent; border: none; font-size: 25px; outline: none">ðŸ”ˆ</button>
                    </b-table-column>

                </template>

            </b-table>

        </div>
    </div>
</section>

    
</template>

<script>
import { mapGetters } from 'vuex';

    export default {
        data () {
            return {
                artistData: '',
                artistTopTracks: [],
                click: 0,
                isPlaying: false
            }
        },

        computed: {
            ...mapGetters(['getArtist', 'getArtistTopTracks'])
        },

        methods: {
            playPreview(id) {
                const PLAYER_ELEMENT = this.$refs[(id.toString())];
                const PLAYER_ICON = this.$refs[`${id.toString()}action`];
                if(!this.isPlaying) {
                    this.isPlaying = true
                    PLAYER_ELEMENT.play();
                    PLAYER_ICON.innerHTML = "ðŸ”Š"
                } else {
                    this.isPlaying = false
                    PLAYER_ELEMENT.pause()
                    PLAYER_ICON.innerHTML = "ðŸ”ˆ"
                }
            }
        },

        created () {
            this.artistData = this.getArtist;
            this.artistTopTracks = this.getArtistTopTracks.data;
            console.log(this.artistData)
            console.log(this.artistTopTracks)
        }
    }
</script>
